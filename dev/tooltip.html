<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tooltip</title>
    <script type="module" src="./common.js"></script>
    <script type="module">
      import { Tooltip } from '@vaadin/tooltip';

      // Show after 1 second
      Tooltip.setDefaultTooltipDelay(1000);

      // Hide after 0.5 seconds
      Tooltip.setDefaultTooltipCooldown(500);
    </script>
  </head>
  <style>
    tooltip-demo {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .position {
      width: 200px;
      height: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-basis: 9999px;
    }
  </style>

  <body>
    <!--
      Wrap demo into the component so that global cooldown / delay work
      for all the `<vaadin-tooltip>` instances, including those that are
      created in HTML (placing them in `<body>` would break this logic).
      Do not use Shadow DOM in the demo so that `aria-describedby` works.
    -->
    <tooltip-demo></tooltip-demo>

    <script type="module">
      import { TooltipHostMixin } from '@vaadin/tooltip/src/vaadin-tooltip-host-mixin.js';
      import { html, PolymerElement } from '@polymer/polymer';

      customElements.define(
        'tooltip-demo',
        class extends PolymerElement {
          static get template() {
            return html`
              <button id="user">User</button>
              <vaadin-tooltip target-id="user" text="View user profile"></vaadin-tooltip>

              <input id="name" autocomplete="off" />
              <vaadin-tooltip target-id="name" text="Enter your name"></vaadin-tooltip>

              <tooltip-host id="property" tooltip-text="I'm a property tooltip">Property tooltip</tooltip-host>

              <tooltip-host id="slotted">
                <div>Slotted tooltip</div>
                <vaadin-tooltip slot="tooltip" text="I'm a slotted tooltip"></vaadin-tooltip>
              </tooltip-host>

              <tooltip-host id="lazy">
                <div>Lazy tooltip (click to add)</div>
              </tooltip-host>

              <tooltip-host
                id="manual"
                tooltip-text="Only shown when checked"
                tooltip-manual
                tooltip-opened="[[manualOpened]]"
              >
                <input type="checkbox" id="checkbox" />
                <label for="check">Manual (check to show)</label>
              </tooltip-host>

              <tooltip-host
                id="immediate"
                tooltip-delay="0"
                tooltip-cooldown="0"
                tooltip-text="Zero delay or cooldown!"
              >
                <div>Immediate tooltip</div>
              </tooltip-host>

              <div class="position">
                <tooltip-host>
                  <div>Positioned tooltip</div>
                  <select id="position">
                    <option value="top">top</option>
                    <option value="bottom" selected>bottom</option>
                    <option value="start">start</option>
                    <option value="end">end</option>
                  </select>
                  <vaadin-tooltip slot="tooltip" position="[[position]]" text="Position: [[position]]"></vaadin-tooltip>
                </tooltip-host>
              </div>
            `;
          }

          _attachDom(dom) {
            this.appendChild(dom);
          }

          static get properties() {
            return {
              position: {
                type: String,
                value: 'bottom',
              },
              manualOpened: {
                type: Boolean,
              },
            };
          }

          ready() {
            super.ready();

            const lazy = this.querySelector('#lazy');
            lazy.addEventListener('click', (e) => {
              lazy.tooltipText = 'Only shown after first click';
              const div = lazy.firstElementChild;
              div.textContent = 'Lazy (added)';
            });

            this.querySelector('#checkbox').addEventListener('change', (e) => {
              this.manualOpened = e.target.checked;
            });

            this.querySelector('#position').addEventListener('change', (e) => {
              this.position = e.target.value;
            });
          }
        },
      );

      customElements.define(
        'tooltip-host',
        class extends TooltipHostMixin(PolymerElement) {
          static get template() {
            return html`
              <style>
                :host {
                  display: block;
                  padding: 5px 10px;
                  border: solid 1px #e2e2e2;
                  text-align: center;
                }
              </style>
              <slot></slot>
              <slot name="tooltip"></slot>
            `;
          }
        },
      );
    </script>
  </body>
</html>
